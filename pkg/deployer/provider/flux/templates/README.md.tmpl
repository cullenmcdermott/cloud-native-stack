# Cloud Native Stack Bundle - Flux Deployment

Generated: {{ .Timestamp }}

## Components

{{- range .Components }}
- **{{ .Name }}** ({{ .Version }})
{{- end }}

## Prerequisites

- Flux v2 installed in your cluster
- Git repository to host bundle manifests
- flux CLI installed locally

## Deployment

1. Push bundle to Git repository:
   ```bash
   git add .
   git commit -m "Add CNS bundle"
   git push
   ```

2. Create GitRepository source:
   ```bash
   flux create source git cns-bundle \
     --url=<YOUR_GIT_REPO> \
     --branch=main \
     --namespace=flux-system
   ```

3. Deploy the parent Kustomization:
   ```bash
   kubectl apply -f flux/kustomization.yaml
   ```

4. Apply component HelmReleases:
   ```bash
   kubectl apply -f gpu-operator/helmrelease.yaml
   # Repeat for other components
   ```

5. Verify deployment:
   ```bash
   flux get helmreleases -A
   flux get kustomizations
   kubectl get pods -A
   ```

## Architecture

This bundle uses:
- **Flux Kustomization** - For GitOps reconciliation of the bundle
- **HelmRelease** - For deploying each component via Helm
- **HelmRepository** - For sourcing charts from NVIDIA registries

## Notes

- Flux reconciles changes every 10 minutes by default
- HelmReleases manage component lifecycle
- Namespaces are created automatically by Helm
- Edit values.yaml files in component directories to customize deployments
